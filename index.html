<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> محاسبه گرم قلک طلا</title>
    <link rel="stylesheet" href="./main.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            direction: rtl;
            text-align: right;
            margin: 20px;
        }
        label, input {
            display: block;
            margin-bottom: 10px;
        }
        input[type="text"] {
            width: 250px;
            padding: 5px;
            text-align: left;
            direction: ltr;
        }
        .result {
            margin-top: 10px;
            font-weight: bold;
            color: blue;
        }
    </style>
</head>
<body>
    <h2>بسم رب الشهدا</h2>

    <h1> محاسبه قیمت طلا طلای طاها</h1>

    <label for="numberInput">قیمت لحظه ای را وارد کنید:</label>
    <input type="number" id="numberInput" oninput="updateFormattedNumber()">

    <div class="result" id="formattedOutput"></div>


    <label for="numberInput">درصد طلا را وارد کنید :</label>
    <input type="number" id="numberInput1" oninput="updateFormattedNumber2()">

    <div class="result" id="formattedOutput2"></div>


    <label for="numberInput">وزن کالا را وارد کنید :</label>
    <p>سوت را با نقطه از عدد جدا کنید مثل ۱.۵</p>
    <input type="number" id="numberInput2" step="any" oninput="updateFormattedNumber3()">

    <div class="result" id="formattedOutput3"></div>


    <br><div class="result" id="result"></div><br>
    <div class="result" id="horof"></div><br>

    <textarea id="myText" rows="12" cols="40">
        .....
        </textarea><br/>
        <div style="display: flex;justify-content: start; align-items: start;">
            <button onclick="copyText()">کپی کردن متن</button>
            <p id="pcopy" style="display: none;">متن کپی شد .</p>
        </div>
       
        <script src="./utils/wordifyfa.min.js"></script>
    <script>
        let api = "https://api.navasan.tech/latest/?item=18ayar&api_key=freewDvLQYonK8v62ne37BoG977LHoZl"
        let priceLahzeh;
        function updateFormattedNumber() {
            let input = document.getElementById('numberInput').value.replace(/,/g, '');
            
            if (!/^\d*$/.test(input)) return; // اگر عدد نبود، اجرا نکند
            
           priceLahzeh = Number(input).toLocaleString('fa-IR'); // جدا کردن سه‌رقمی

            document.getElementById('formattedOutput').innerText = priceLahzeh;
            claculte()
        }
        
        let darsadeTala ;
        function updateFormattedNumber2() {
            let input = document.getElementById('numberInput1').value.replace(/,/g, '');
            console.log(input)
            if (!/^\d*$/.test(input)) return; // اگر عدد نبود، اجرا نکند
            
            darsadeTala = Number(input).toLocaleString('fa-IR'); // جدا کردن سه‌رقمی

            document.getElementById('formattedOutput2').innerText = darsadeTala;
            darsadeTala = input;
            claculte()
        }
        let vazneTala;

        function updateFormattedNumber3() {
            let input = document.getElementById('numberInput2').value;
            vazneTala = parseFloat(input);

            claculte();
        }

        function claculte(){
            // افزودن ۲٪ به قیمت هر گرم طلا
            let adjustedPrice = document.getElementById('numberInput').value * (1+darsadeTala/100);

            
            let geymateTala = vazneTala * adjustedPrice;
            geymateTala = Math.round(geymateTala / 1000) * 1000;

            let geymateTala1 = Number(geymateTala).toLocaleString('fa-IR');
        

            document.getElementById('result').innerText = `قیمت طلا : ${geymateTala1}`;
            document.getElementById('horof').innerText = wordifyfa(geymateTala)
        
        }


            function createReshteh(vazne){
                let reshteh = `_____________________________

واریزی اول : ${date}  ---- ${time}

قیمت لحظه طلا: ${priceLahzeh}   تومان

مبلغ واریزی: ${darsadeTaha}   تومان

‌وزن طلا: ${vazne}`;
            console.log(reshteh)
            document.getElementById('myText').innerHTML = reshteh;
            }
  
            function copyText() {
            // دریافت متن از textarea
            const text = document.getElementById("myText").value;

            // استفاده از Clipboard API برای کپی کردن
            navigator.clipboard.writeText(text)
                .then(() => {
                    document.getElementById('pcopy').style.display = 'block';
                    
                    setTimeout(function() {
                        document.getElementById("pcopy").style.display = "none";
                    }, 1000); // 1000 میلی‌ثانیه = 1 ثانیه
                
                })
                .catch((error) => {
                    console.error("خطا در کپی کردن متن:", error);
                });
        }
    </script>

</body>
</html>

